#!/usr/bin/env php

<?php

use Classes\DependencyInjection\DependencyInjection;
use Classes\DependencyInjection\ClassBuilder;
use Classes\DependencyInjection\Container;
use Classes\Model\Orm\SchemaGenerator;
use Classes\Model\Orm\EntityGenerator;

//set_time_limit(0);
define('ROOT_DIR', dirname(dirname(__FILE__)));
require ROOT_DIR . '/lib/classes/DependencyInjection/Autoload.php';

$parameters = (new DependencyInjection())->getParameters();

/** @var Container $container */
$container = new ClassBuilder($parameters);

if (array_search('generate', $argv)) {
    $entity = $argv[2];

    /** @var EntityGenerator $entityGenerator */
    $entityGenerator = $container->get('entity.generator');
    $entityGenerator->generateFile($entity);
}

if (array_search('create-schema', $argv)) {
    /** @var SchemaGenerator $schemaGenerator */
    $schemaGenerator = $container->get('schema.generator');
    $schemaGenerator->createSchema();
}